{"paragraphs":[{"text":"%md\n# Monitoring YARN\n\nThis notebook shows you some tricks for monitoring YARN, the resource scheduling system for Hadoop.  These can be useful on very small BDCS-CE clusters (especially the 2OCPU OC2M shape) where YARN processes can get stuck waiting for resources.\n\nHere are 3 techniques for monitoring YARN\n\n+ Connect to the Resource Manager web UI\n+ Run the \"yarn top\" command via SSH\n+ Run various yarn commands via notebook\n\n","dateUpdated":"2017-11-15T18:10:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":"true"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Monitoring YARN</h1>\n<p>This notebook shows you some tricks for monitoring YARN, the resource scheduling system for Hadoop. These can be useful on very small BDCS-CE clusters (especially the 2OCPU OC2M shape) where YARN processes can get stuck waiting for resources.</p>\n<p>Here are 3 techniques for monitoring YARN</p>\n<ul>\n  <li>Connect to the Resource Manager web UI</li>\n  <li>Run the &ldquo;yarn top&rdquo; command via SSH</li>\n  <li>Run various yarn commands via notebook</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1510769459721_-221433432","id":"20170823-183628_2032714173","dateCreated":"2017-11-15T18:10:59+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:320"},{"text":"%md\n# Connect to Resource Manager web UI\n\nThe Resource Manager web UI runs on port 8088 on the BDCS-CE Master server.  You can either open this port via an Access Rule or connect to it via SSH Tunneling.\n\nTo do so, follow the instructions in the note \"xtra Connecting to Ambari\" but use port 8088 instead of 8080 and http instead of https.\n\n![ResourceMgr](https://raw.githubusercontent.com/oracle/learning-library/master/workshops/journey2-new-data-lake/images/200/snap0012328.jpg)\n\n","dateUpdated":"2017-11-15T18:10:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":"true"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Connect to Resource Manager web UI</h1>\n<p>The Resource Manager web UI runs on port 8088 on the BDCS-CE Master server. You can either open this port via an Access Rule or connect to it via SSH Tunneling.</p>\n<p>To do so, follow the instructions in the note &ldquo;xtra Connecting to Ambari&rdquo; but use port 8088 instead of 8080 and http instead of https.</p>\n<p><img src=\"https://raw.githubusercontent.com/oracle/learning-library/master/workshops/journey2-new-data-lake/images/200/snap0012328.jpg\" alt=\"ResourceMgr\" /></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1510769459721_-221433432","id":"20170823-210043_33659668","dateCreated":"2017-11-15T18:10:59+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:321"},{"text":"%md\n# Run the \"yarn top\" command via SSH\n\nAnother way you can monitor yarn is via logging into BDCS-CE via SSH and running the \"yarn top\" command.  Refer to the note \"xtra Connecting via SSH\" to connect via SSH.  Then type \"yarn top\" to launch the tool.  Type \"h\" followed by enter to view help.\n\n![Yarn top](https://raw.githubusercontent.com/oracle/learning-library/master/workshops/journey2-new-data-lake/images/200/snap0012329.jpg)","dateUpdated":"2017-11-15T18:10:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":"true"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Run the &ldquo;yarn top&rdquo; command via SSH</h1>\n<p>Another way you can monitor yarn is via logging into BDCS-CE via SSH and running the &ldquo;yarn top&rdquo; command. Refer to the note &ldquo;xtra Connecting via SSH&rdquo; to connect via SSH. Then type &ldquo;yarn top&rdquo; to launch the tool. Type &ldquo;h&rdquo; followed by enter to view help.</p>\n<p><img src=\"https://raw.githubusercontent.com/oracle/learning-library/master/workshops/journey2-new-data-lake/images/200/snap0012329.jpg\" alt=\"Yarn top\" /></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1510769459722_-220279185","id":"20170823-210336_22884452","dateCreated":"2017-11-15T18:10:59+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:322"},{"text":"%md\n# Run various yarn commands via notebook\n\nAnother way to monitor yarn is via a series of yarn commands run in the notebook shell interpreter.  The following paragraphs provide a few examples you can use and modify.","dateUpdated":"2017-11-15T18:10:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":"true"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Run various yarn commands via notebook</h1>\n<p>Another way to monitor yarn is via a series of yarn commands run in the notebook shell interpreter. The following paragraphs provide a few examples you can use and modify.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1510769459722_-220279185","id":"20170823-210529_1115413889","dateCreated":"2017-11-15T18:10:59+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:323"},{"title":"Script to see the Used versus Capacity for YARN CPU and Memory","text":"%sh\nexport YARN_ROOT_LOGGER=WARN\nexport NODEID=`yarn node -list -all | tail -1 | cut -f1`\necho $NODEID\nyarn node -status $NODEID\n","dateUpdated":"2017-11-16T16:24:34+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":"false"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510769459722_-220279185","id":"20170823-190454_1112719671","dateCreated":"2017-11-15T18:10:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:324","user":"anonymous","dateFinished":"2017-11-16T16:23:28+0000","dateStarted":"2017-11-16T16:23:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dcbnov15c-bdcsce-1.compute-gse00002281.oraclecloud.internal:45454\nNode Report : \n\tNode-Id : dcbnov15c-bdcsce-1.compute-gse00002281.oraclecloud.internal:45454\n\tRack : /default-rack\n\tNode-State : RUNNING\n\tNode-Http-Address : dcbnov15c-bdcsce-1.compute-gse00002281.oraclecloud.internal:8042\n\tLast-Health-Update : Thu 16/Nov/17 04:22:56:328UTC\n\tHealth-Report : \n\tContainers : 2\n\tMemory-Used : 2048MB\n\tMemory-Capacity : 15821MB\n\tCPU-Used : 2 vcores\n\tCPU-Capacity : 3 vcores\n\tNode-Labels : \n\n"}]}},{"title":"Script to see the current YARN applications and State","text":"%sh\nexport YARN_ROOT_LOGGER=WARN\nyarn application -list\n","dateUpdated":"2017-11-16T16:24:37+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":"false"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510769459723_-220663934","id":"20170823-183707_2061582102","dateCreated":"2017-11-15T18:10:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:325","user":"anonymous","dateFinished":"2017-11-16T16:23:47+0000","dateStarted":"2017-11-16T16:23:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Total number of applications (application-types: [] and states: [SUBMITTED, ACCEPTED, RUNNING]):2\n                Application-Id\t    Application-Name\t    Application-Type\t      User\t     Queue\t             State\t       Final-State\t       Progress\t                       Tracking-URL\napplication_1510769091693_0011\tThrift JDBC/ODBC Server\t               SPARK\t      hive\t   default\t           RUNNING\t         UNDEFINED\t            10%\t         http://10.196.177.198:4040\napplication_1510769091693_0007\t            Zeppelin\t               SPARK\t  zeppelin\tinteractive\t           RUNNING\t         UNDEFINED\t            10%\t         http://10.196.177.198:4041\n"}]}},{"text":"%sh\n","dateUpdated":"2017-11-15T18:10:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":"false"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510769459723_-220663934","id":"20170823-184253_1294363530","dateCreated":"2017-11-15T18:10:59+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:327"}],"name":"Extras/Monitoring YARN","id":"2CZAK7XFJ","angularObjects":{"2CYSDQRTD:shared_process":[],"2CXZGEME1:shared_process":[],"2CYUAMVSY:shared_process":[],"2CZXWA6ZX:shared_process":[],"2CX2H9AR3:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CXNDMXPX:shared_process":[],"2CXEDJX5E:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}